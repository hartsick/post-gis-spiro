function onSuccess(o){if(isReady){isReady=!1,$.ajax({type:"POST",url:"/user_locations",data:{lat:o.coords.latitude,lng:o.coords.longitude,accuracy:o.coords.accuracy,timestamp:o.timestamp,user_id:2}}),console.log("markerCounter:",markerCounter,"|",o.coords.latitude,o.coords.longitude);var e={lat:parseFloat(o.coords.latitude),lng:parseFloat(o.coords.longitude)};map.setCenter(e);var t={strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:1,fillColor:"#FF0000",fillOpacity:.35,map:map,center:e,radius:30};cityCircle=new google.maps.Circle(t),markerCounter++,currentTime=(new Date).getTime(),console.log("Time:",currentTime,"|","Next running:",currentTime+3e4),window.setTimeout(function(){isReady=!0},3e4)}}function onError(o){console.log("code: "+o.code+" | message: "+o.message)}var watchID=!1,options={enableHighAccuracy:!0,timeout:5e3,maximumAge:0},isReady=!0,markerCounter=1;$("#session-control").click(function(){watchID?(navigator.geolocation.clearWatch(watchID),console.log(watchID,"session ended."),watchID=!1,$(this).text("Start Tracking")):(watchID=navigator.geolocation.watchPosition(onSuccess,onError,options),console.log(watchID,"session started."),$(this).text("Stop Tracking"))});